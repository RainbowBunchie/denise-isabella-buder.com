<script setup lang="ts">
import { onMounted } from 'vue';
import gsap from 'gsap';
import Draggable from 'gsap/Draggable';

gsap.registerPlugin(Draggable);

onMounted(() => {
  const blink = gsap.timeline({
    repeat: 10,
    repeatDelay: 5,
    paused: false,
  });

  blink
    .to(
      '.eyes--open .eye--left, .eyes--open .eye--right',
      {
        duration: 0.01,
        opacity: 0,
      },
      0
    )
    .to(
      '.eyes--closed .eye--left, .eyes--closed .eye--right',
      {
        duration: 0.01,
        opacity: 1,
      },
      0
    )
    .to(
      '.eyes--open .eye--left, .eyes--open .eye--right',
      {
        duration: 0.01,
        opacity: 1,
      },
      0.15
    )
    .to(
      '.eyes--closed .eye--left, .eyes--closed .eye--right',
      {
        duration: 0.01,
        opacity: 0,
      },
      0.15
    );

  blink.play();

  // mouse stuff

  let xPosition: number;
  let yPosition: number;

  let height: number;
  let width: number;

  function percentage(partialValue: number, totalValue: number) {
    console.log('percetage');
    console.log(partialValue);
    console.log(totalValue);
    return (100 * partialValue) / totalValue;
  }

  let storedXPosition = 0;
  let storedYPosition = 0;

  const dom = {
    eye: document.querySelectorAll('.eye'),
  };

  function animateFace() {
    if (!xPosition) return;
    // important, only recalculating if the value changes
    if (storedXPosition === xPosition && storedYPosition === yPosition) return;

    // range from -50 to 50
    const x = percentage(xPosition, width) - 50;
    const y = percentage(yPosition, height) - 50;

    // range from -20 to 80
    const yHigh = percentage(yPosition, height) - 20;
    // range from -80 to 20
    const yLow = percentage(yPosition, height) - 80;

    console.log('animating....');

    console.log(yHigh);
    console.log(x);

    gsap.to(dom.eye, {
      yPercent: yHigh / 3,
      xPercent: x / 2,
    });

    storedXPosition = xPosition;
    storedYPosition = yPosition;
  }

  function updateScreenCoords(event: MouseEvent) {
    xPosition = event.clientX;
    yPosition = event.clientY;
  }

  // update if browser resizes
  function updateWindowSize() {
    height = window.innerHeight;
    width = window.innerWidth;
  }
  updateWindowSize();
  window.addEventListener('resize', updateWindowSize);

  addMouseEvent();

  // function being called at the end of main timeline
  function addMouseEvent() {
    const safeToAnimate = window.matchMedia(
      '(prefers-reduced-motion: no-preference)'
    ).matches;

    if (safeToAnimate) {
      window.addEventListener('mousemove', updateScreenCoords);

      // gsap's RAF, falls back to set timeout
      gsap.ticker.add(animateFace);

      blink.play();
    }
  }
});
</script>

<template>
  <svg
    version="1.1"
    xmlns="http://www.w3.org/2000/svg"
    xmlns:xlink="http://www.w3.org/1999/xlink"
    x="0px"
    y="0px"
    width="1749.175px"
    height="50vh"
    viewBox="0 0 1749.175 1824"
    enable-background="new 0 0 1749.175 1824"
    xml:space="preserve"
  >
    <g id="hair">
      <path
        id="hair_1_"
        fill="#BC1330"
        d="M5.427,1812h1739.076c-107.309-146-218.175-347.299-220.271-571.568
		c-4.079-436.487,12.237-844.65-228.441-1085.33C1055.111-85.577,810.353,28.526,810.353,28.526S386.104,16.23,235.17,338.496
		c-150.934,322.266,32.635,816.298-73.426,1077.375C115.506,1529.685,56.868,1678,5.427,1812z"
      />
    </g>
    <path
      fill="#3F3937"
      d="M1337.575,1812l12.012-0.721c0,0-37.535-177.424-89.204-225.014
		C1208.708,1538.675,1010.091,1464,1010.091,1464H724.855c0,0-198.608,74.443-250.281,122.033
		c-51.672,47.588-89.234,225.674-89.234,225.674l11.789,0.293H1337.575z"
    />
    <path
      fill="#EACDC1"
      d="M866.787,1513.283c-73.428,0-142.098-48.252-142.098-48.252C743.387,1446.333,738.284,1325,738.284,1325
		h257.681c0,0-5.103,121.333,13.596,140.031C1009.562,1465.031,940.214,1513.283,866.787,1513.283"
    />
    <g id="eyes">
      <path
        fill="#FFE8DC"
        d="M1404.307,821.836c-27.535-61.191-91.784-32.125-91.784-32.125
		c11.728-39.264,10.198-109.631,10.198-109.631c-43.582-22.994-87.243-41.479-130.565-56.205
		c-7.39-65.601-34.042-113.086-34.042-113.086c9.781,41.08,4.554,79.635-0.489,102.115c-38.622-11.422-76.889-19.971-114.488-26.03
		c-1.363-67.994-30.858-103.621-30.858-103.621c11.325,30.65,6.983,73.475,2.609,99.493c-74.777-9.752-146.568-10.123-212.881-4.824
		c-2.047-42.929-17.149-77.333-17.149-77.333c-11.976,39.67-11.864,67.74-10.956,79.901c-29.495,3.119-57.784,7.294-84.622,12.177
		c-12.815-49.533-2.326-144.089-2.326-144.089c-32.388,56.492-29.726,120.176-26.125,149.631
		c-38.264,7.945-73.173,17.15-103.923,26.476c-11.253-40.656,5.629-113.898,5.629-113.898
		c-30.748,27.174-35.417,88.906-35.467,123.391c-71.861,23.91-114.448,45.893-114.448,45.893s-1.53,70.36,10.198,109.624
		c0,0-64.248-29.077-91.783,32.113c-27.536,61.189-12.239,173.853,18.356,195.78c30.594,21.926,69.348,18.809,94.333,5.042
		c0,0,17.338,145.433,83.626,198.462C593.639,1274.126,733.037,1339,867.145,1374h0.383c134.107-35,274.174-99.874,340.462-152.908
		c66.29-53.029,83.626-198.498,83.626-198.498c24.986,13.771,63.74,16.902,94.334-5.023S1431.842,883.025,1404.307,821.836z"
      />
      <path
        fill="#C99B8F"
        d="M583.449,750.781c0,0,1.17-2.073,3.679-5.36c1.276-1.62,2.84-3.607,4.849-5.681
		c1.004-1.04,2.077-2.148,3.208-3.314c1.211-1.084,2.485-2.224,3.817-3.414c1.304-1.235,2.788-2.363,4.344-3.508
		c1.567-1.131,3.104-2.446,4.854-3.532c3.499-2.179,7.21-4.512,11.377-6.299c4.032-2.122,8.507-3.517,13.036-5.091
		c2.239-0.903,4.64-1.187,6.989-1.796c2.368-0.494,4.739-1.16,7.146-1.51c4.818-0.456,9.696-1.358,14.493-1.422
		c2.398-0.021,4.791-0.079,7.155-0.04c2.366,0.005,4.714,0.029,6.955,0.452c4.497,0.771,8.846,1.591,12.874,2.65
		c3.938,1.361,7.614,2.749,10.955,4.125c1.683,0.645,3.265,1.344,4.761,2.004c1.438,0.818,2.816,1.531,4.072,2.31
		c2.527,1.495,4.694,2.836,6.442,4c3.508,2.3,5.382,3.798,5.382,3.798l-0.498,1.119c0,0-2.458-0.192-6.531-0.85
		c-2.042-0.317-4.478-0.771-7.226-1.337c-1.388-0.251-2.817-0.635-4.342-0.975c-1.562-0.196-3.199-0.397-4.876-0.694
		c-3.376-0.506-6.976-1.153-10.734-1.951c-3.838-0.329-7.812-0.865-11.908-1.556c-2.036-0.507-4.133-0.546-6.245-0.807
		c-2.115-0.208-4.259-0.511-6.43-0.786c-2.177-0.401-4.358-0.298-6.562-0.304l-6.652-0.007c-2.215,0.1-4.392,0.504-6.595,0.734
		c-2.178,0.345-4.438,0.363-6.531,0.999c-4.246,1.034-8.519,1.888-12.407,3.485c-4.04,1.234-7.627,3.15-11.179,4.735
		c-1.771,0.805-3.342,1.854-4.956,2.728c-1.605,0.892-3.146,1.777-4.519,2.79c-1.409,0.969-2.758,1.9-4.042,2.783
		c-1.216,0.978-2.372,1.9-3.458,2.772c-2.168,1.752-3.917,3.455-5.394,4.82c-2.887,2.811-4.297,4.625-4.297,4.625L583.449,750.781z"
      />
      <path
        fill="#C99B8F"
        d="M904.109,979.967c0,0,0.178,0.36,0.51,1.037c0.139,0.349,0.355,0.729,0.525,1.267
		c0.143,0.586,0.24,1.304,0.29,2.157c0.057,1.62-0.042,3.58-0.791,5.715c-0.35,1.058-0.83,2.122-1.367,3.293
		c-0.597,1.039-1.32,2.191-2.139,3.212c-1.615,2.146-3.629,4.221-6.004,5.979c-2.367,1.774-5.031,3.333-7.905,4.556
		c-1.426,0.637-2.922,1.192-4.439,1.633c-1.518,0.521-3.074,0.892-4.658,1.18c-3.156,0.696-6.407,0.878-9.645,0.982
		c-2.08-0.095-2.781-0.108-4.585-0.253c-1.713-0.158-3.536-0.409-5.061-0.744c-1.583-0.286-3.136-0.676-4.654-1.188
		c-1.517-0.431-3.01-1.003-4.436-1.634c-5.73-2.422-10.702-6.217-13.898-10.533c-0.819-1.019-1.548-2.162-2.138-3.207
		c-0.536-1.17-1.02-2.23-1.371-3.289c-0.745-2.113-0.858-4.123-0.785-5.666c0.071-1.576,0.477-3.178,0.796-3.918
		c0.299-0.738,0.503-1.545,0.503-1.545h1.224c0.101,0-0.082,1.803,0.693,3.955c0.392,1.062,1.025,2.531,1.971,3.813
		c0.979,1.263,2.245,2.676,3.811,3.906c3.137,2.435,7.393,4.665,12.268,5.985c2.428,0.68,4.99,1.257,7.629,1.569
		c2.6,0.361,5.315,0.476,8.032,0.5c5.395,0.032,10.799-0.655,15.66-2.021c4.876-1.322,9.13-3.489,12.268-5.925
		c1.565-1.227,2.831-2.529,3.809-3.789c0.945-1.28,1.583-2.528,1.971-3.577c0.347-1.022,0.563-1.898,0.585-2.575
		c0.073-0.642,0.113-0.984,0.113-0.984L904.109,979.967z"
      />
      <path
        id="mouth"
        fill="#D66979"
        d="M753.585,1111.18c0,0,0.653,0.816,1.882,2.345c0.628,0.747,1.343,1.747,2.291,2.775
		c1.012,0.947,2.102,2.04,3.269,3.25c2.494,2.346,5.78,5.018,9.67,7.718c3.912,2.702,8.641,5.25,13.802,7.864
		c5.342,2.368,11.126,4.78,17.489,6.798c6.294,2.142,13.211,3.602,20.265,5.257c7.148,1.408,14.6,2.379,22.208,3.174
		c7.594,0.899,15.394,1.05,23.169,1.091c3.49-0.077,8.238,0.018,11.864-0.216c3.759-0.24,7.471-0.36,11.306-0.863
		c7.615-0.76,15.065-1.762,22.215-3.162c7.052-1.66,13.978-3.096,20.27-5.254c6.362-2.021,12.154-4.422,17.491-6.8
		c5.159-2.622,9.895-5.166,13.803-7.874c3.893-2.715,7.156-5.353,9.682-7.75c1.189-1.247,2.291-2.365,3.303-3.323
		c0.929-1.005,1.613-1.945,2.232-2.681c1.215-1.511,1.865-2.314,1.865-2.314l1.115,0.505c0,0-0.482,0.922-1.389,2.646
		c-0.469,0.854-0.974,1.953-1.708,3.158c-0.799,1.162-1.717,2.501-2.744,4.002c-2.18,2.896-5.058,6.265-8.791,9.673
		c-1.775,1.808-4,3.335-6.162,5.161c-2.263,1.698-4.751,3.339-7.334,5.056c-5.328,3.172-11.227,6.447-17.828,9.083
		c-6.521,2.835-13.688,5.069-21.151,7.124c-7.524,1.816-15.365,3.521-23.451,4.418c-8.08,1.109-16.35,1.466-24.586,1.64
		c-8.258-0.168-16.524-0.53-24.586-1.635c-8.087-0.897-15.928-2.604-23.451-4.418c-7.466-2.058-14.633-4.29-21.152-7.127
		c-6.603-2.638-12.5-5.911-17.829-9.083c-2.583-1.718-5.069-3.357-7.332-5.056c-2.164-1.828-4.39-3.353-6.165-5.16
		c-3.735-3.413-6.604-6.771-8.794-9.683c-1.034-1.507-1.957-2.857-2.759-4.028c-0.731-1.203-1.224-2.278-1.689-3.123
		c-0.894-1.705-1.372-2.613-1.372-2.613L753.585,1111.18z"
      />
      <path
        fill="#C99B8F"
        d="M1151.493,747.399c0,0-1.412-1.815-4.297-4.626c-1.476-1.367-3.226-3.068-5.395-4.82
		c-1.085-0.87-2.24-1.794-3.458-2.774c-1.285-0.881-2.634-1.812-4.041-2.781c-1.373-1.013-2.915-1.896-4.52-2.79
		c-1.614-0.875-3.186-1.925-4.956-2.728c-3.552-1.583-7.14-3.501-11.179-4.735c-3.887-1.598-8.16-2.451-12.407-3.485
		c-2.093-0.636-4.354-0.653-6.531-0.999c-2.203-0.23-4.381-0.634-6.595-0.734l-6.653,0.005c-2.203,0.01-4.384-0.095-6.561,0.306
		c-2.171,0.273-4.314,0.579-6.43,0.785c-2.111,0.261-4.208,0.3-6.244,0.807c-4.097,0.691-8.07,1.228-11.909,1.556
		c-3.758,0.797-7.357,1.444-10.734,1.95c-1.677,0.296-3.313,0.498-4.876,0.696c-1.525,0.338-2.954,0.721-4.342,0.973
		c-2.75,0.567-5.186,1.021-7.227,1.337c-4.073,0.66-6.531,0.85-6.531,0.85l-0.499-1.119c0,0,1.874-1.498,5.382-3.798
		c1.749-1.164,3.916-2.506,6.443-4c1.255-0.778,2.634-1.491,4.072-2.31c1.496-0.66,3.077-1.359,4.76-2.005
		c3.34-1.375,7.017-2.764,10.955-4.125c4.028-1.059,8.375-1.878,12.873-2.649c2.241-0.424,4.589-0.448,6.956-0.451
		c2.364-0.041,4.756,0.018,7.154,0.039c4.796,0.064,9.674,0.966,14.494,1.422c2.408,0.351,4.778,1.016,7.146,1.511
		c2.349,0.608,4.751,0.892,6.99,1.795c4.527,1.575,9.003,2.968,13.035,5.093c4.167,1.786,7.88,4.118,11.378,6.297
		c1.75,1.085,3.286,2.402,4.854,3.532c1.556,1.145,3.04,2.272,4.343,3.508c1.331,1.19,2.606,2.331,3.817,3.413
		c1.131,1.168,2.202,2.276,3.208,3.314c2.009,2.074,3.572,4.062,4.848,5.683c2.511,3.289,3.68,5.359,3.68,5.359L1151.493,747.399z"
      />
    </g>
    <g id="Ears">
      <path
        fill="#C99B8F"
        d="M410.54,841.698c0,0-0.238-0.042-0.68-0.119c-0.356-0.07-0.938-0.165-1.791-0.263
		c-1.643-0.209-4.078-0.407-7.022-0.422c-2.955-0.05-6.405,0.197-10.101,0.694c-1.827,0.308-3.734,0.64-5.64,1.106
		c-1.874,0.541-3.857,0.961-5.7,1.731l-2.828,1.04l-2.695,1.292c-1.84,0.796-3.488,1.849-5.103,2.869
		c-1.685,0.939-3.089,2.141-4.482,3.234c-0.693,0.554-1.368,1.094-2.02,1.615c-0.59,0.593-1.159,1.163-1.708,1.714
		c-1.075,1.12-2.168,2.079-2.965,3.069c-0.788,1.006-1.472,1.882-2.036,2.605c-1.14,1.46-1.789,2.295-1.789,2.295
		s0.491-0.936,1.345-2.576c0.432-0.826,0.958-1.831,1.562-2.984c0.625-1.145,1.533-2.298,2.425-3.646
		c0.462-0.667,0.942-1.363,1.438-2.084c0.571-0.659,1.163-1.343,1.771-2.043c1.233-1.396,2.498-2.939,4.075-4.25
		c1.51-1.392,3.085-2.847,4.886-4.059l2.671-1.933l2.854-1.697c1.887-1.211,3.932-2.07,5.913-3.05
		c2.005-0.897,4.039-1.654,6.021-2.37c3.99-1.309,7.821-2.293,11.168-2.854c3.344-0.6,6.183-0.888,8.221-1.004
		c0.991-0.069,1.855-0.093,2.482-0.092c0.542-0.003,0.831-0.006,0.831-0.006L410.54,841.698z"
      />
      <circle fill="#3F3937" cx="416.7" cy="905.461" r="11.218" />
      <path
        fill="#3F3937"
        d="M432.507,1001.58c0,9.712-7.876,17.592-17.592,17.592s-17.592-7.88-17.592-17.592
		c0-9.711,7.875-17.592,17.592-17.592S432.507,991.869,432.507,1001.58z"
      />
      <circle fill="#3F3937" cx="373.102" cy="996.481" r="14.532" />
      <circle fill="#3F3937" cx="349.646" cy="973.025" r="11.474" />
      <path
        fill="#C99B8F"
        d="M1333.253,830.965c0,0,0.239-0.002,0.689-0.01c0.527-0.012,1.26-0.012,2.082,0.025
		c1.699,0.053,4.057,0.236,6.844,0.647c2.783,0.404,5.986,1.084,9.322,2.076c1.667,0.498,3.362,1.123,5.058,1.766
		c1.665,0.775,3.394,1.381,4.992,2.334c1.629,0.865,3.226,1.75,4.692,2.819c1.52,0.958,2.9,2.064,4.176,3.195
		c1.334,1.042,2.459,2.237,3.501,3.379c1.086,1.086,2.018,2.188,2.764,3.303c0.773,1.085,1.534,2.024,2.094,2.936
		c0.52,0.934,0.972,1.749,1.344,2.42c0.735,1.327,1.156,2.083,1.156,2.083s-0.577-0.647-1.585-1.782
		c-0.498-0.56-1.104-1.24-1.799-2.019c-0.725-0.746-1.658-1.48-2.599-2.327c-0.916-0.876-2.012-1.701-3.236-2.474
		c-1.18-0.825-2.42-1.669-3.842-2.334c-1.355-0.754-2.783-1.453-4.318-1.989c-1.472-0.647-3.05-1.1-4.619-1.528
		c-1.53-0.516-3.186-0.689-4.719-1.039c-1.582-0.214-3.127-0.427-4.634-0.527c-3.015-0.203-5.823-0.164-8.205,0.022
		c-2.379,0.182-4.335,0.468-5.644,0.725c-0.685,0.122-1.134,0.232-1.409,0.306c-0.352,0.084-0.542,0.128-0.542,0.128
		L1333.253,830.965z"
      />
      <circle fill="#3F3937" cx="1398.283" cy="950.334" r="7.139" />
      <path
        fill="#3F3937"
        d="M1304.97,1001.58c0,9.712,7.876,17.592,17.592,17.592c9.716,0,17.592-7.88,17.592-17.592
		c0-9.711-7.876-17.592-17.592-17.592C1312.846,983.988,1304.97,991.869,1304.97,1001.58z"
      />
      <circle fill="#3F3937" cx="1364.374" cy="996.481" r="14.533" />
      <circle fill="#3F3937" cx="1387.83" cy="973.025" r="11.473" />
      <path
        fill="#3F3937"
        d="M1325.876,808.579c0,4.504,3.648,8.159,8.158,8.159c4.506,0,8.159-3.655,8.159-8.159
		c0-4.51-3.652-8.16-8.159-8.16C1329.524,800.419,1325.876,804.069,1325.876,808.579z"
      />
      <path
        fill="#3F3937"
        d="M1350.352,810.109c0,5.35,4.334,9.687,9.688,9.687c5.35,0,9.688-4.337,9.688-9.687
		c0-5.355-4.339-9.69-9.688-9.69C1354.686,800.419,1350.352,804.753,1350.352,810.109z"
      />
      <path
        fill="#3F3937"
        d="M1413.86,838.537l-6.192-10.279c3.505-2.111,5.598-5.655,5.598-9.48c0-6.252-5.562-11.338-12.397-11.338
		c-6.833,0-12.392,5.086-12.392,11.338c0,3.201,1.491,6.269,4.091,8.416l-7.641,9.253c-5.371-4.435-8.451-10.875-8.451-17.668
		c0-12.869,10.942-23.338,24.392-23.338c13.453,0,24.397,10.469,24.397,23.338C1425.266,826.848,1421.002,834.234,1413.86,838.537z"
      />
      <circle fill="#3F3937" cx="1398.283" cy="852.431" r="7.139" />
    </g>
    <g class="eyes eyes--open">
      <g>
        <path
          class="eyes__eye eye eye--left"
          fill="#3A1004"
          d="M684.165,794.134c-16.4,0-30.813,10.871-39.183,27.312c-3.896,4.915-18.33,18.508-47.869-1.582
			c0,0,10.135,24.991,40.667,26.562c-0.276,2.638-0.466,5.312-0.466,8.043c0,33.329,20.974,60.342,46.852,60.342
			c25.875,0,46.853-27.014,46.853-60.342C731.018,821.15,710.04,794.134,684.165,794.134z"
        />
        <path
          class="eyes__eye eye eye--right"
          fill="#3A1004"
          d="M1136.458,819.864c-29.539,20.089-43.971,6.497-47.867,1.582c-8.37-16.441-22.783-27.312-39.185-27.312
			c-25.873,0-46.852,27.017-46.852,60.336c0,33.329,20.979,60.342,46.852,60.342c25.878,0,46.854-27.014,46.854-60.342
			c0-2.731-0.191-5.405-0.466-8.043C1126.325,844.854,1136.458,819.864,1136.458,819.864z"
        />
      </g>
    </g>
    <g class="eyes eyes--closed">
      <path
        class="eyes__eye eye eye--left"
        fill="#3A1004"
        d="M725.589,852.647c-46.041,36.132-80.84,5.771-82.363,4.401c-3.314-3.018-8.366-2.918-11.57,0.128
		c-0.326,0.187-0.653,0.396-0.981,0.636c-6.707,4.905-18.392,8.083-38.081,2.114c0,0,16.25,19.746,44.451,13.751
		c5.166,3.555,13.899,8.563,25.323,11.405c5.17,1.286,11.208,2.197,17.947,2.197c15.581,0,34.893-4.875,55.769-21.259
		c3.693-2.898,4.337-8.241,1.439-11.934C734.625,850.393,729.282,849.749,725.589,852.647z"
      />
      <path
        class="eyes__eye eye eye--right"
        fill="#3A1004"
        d="M1010.342,852.647c46.041,36.132,80.84,5.771,82.363,4.401c3.314-3.018,8.366-2.918,11.57,0.128
		c0.326,0.187,0.653,0.396,0.981,0.636c6.707,4.905,18.392,8.083,38.081,2.114c0,0-16.25,19.746-44.451,13.751
		c-5.166,3.555-13.899,8.563-25.323,11.405c-5.17,1.286-11.208,2.197-17.947,2.197c-15.581,0-34.893-4.875-55.769-21.259
		c-3.693-2.898-4.337-8.241-1.439-11.934C1001.306,850.393,1006.649,849.749,1010.342,852.647z"
      />
    </g>
  </svg>
</template>

<style scoped>
.hair {
  display: block;
}
</style>
